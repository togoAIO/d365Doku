<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Reuse ER configurations with Excel templates to generate reports in Word format </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Reuse ER configurations with Excel templates to generate reports in Word format ">
    <meta name="generator" content="docfx 2.56.6.0">
    <meta name="description" content="This topic explains how Electronic reporting (ER) formats that were originally designed to generate reports as Microsoft Excel workbooks can be configured to generate reports as Word documents instead.">
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="">
    <meta property="docfx:tocrel" content="../../../../commerce/TOC.html">
    <meta name="searchOption" content="noindex">
    
    
    <meta name="robots" content="NOINDEX, NOFOLLOW">
    <meta name="ms.search.form" content="ERWorkspace, ERSolutionTable, EROperationDesigner, LedgerJournalTable, LedgerJournalTransVendPaym">
    <meta name="ms.search.scope" content="Core, Operations, CrossApp, ShowInHelp">
    <meta name="ms.search.region" content="Global">
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="row">
          <div class="col-sm-12">
            
<div class="sidenav hide-when-search"> 
  <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
  <div class="sidetoggle collapse" id="sidetoggle">
    <div id="sidetoc"></div>
  </div>
</div>
            <div class="row toc-offset">
              
              <div class="col-sm-12 col-md-9">
                <article class="article" id="_content" data-uid="">
<h1 id="reuse-er-configurations-with-excel-templates-to-generate-reports-in-word-format">Reuse ER configurations with Excel templates to generate reports in Word format</h1>


<p>To generate reports as Microsoft Word documents, you can <a href="../er-design-configuration-word.html">configure</a> a new <a href="../general-electronic-reporting.html">Electronic reporting (ER)</a> <a href="../general-electronic-reporting.html#FormatComponentOutbound">format</a>. Alternatively, you can reuse an ER format that was originally designed to generate reports as Excel workbooks. In this case, you must replace the Excel template with a Word template.</p>
<p>The following procedures show how a user in either the System administrator role or the Electronic reporting developer role can configure an ER format to generate reports as Word files by reusing an ER format that was designed to generate reports as Excel files.</p>
<p>These procedures can be completed in the GBSI company.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>To complete these procedures, you must first follow the steps in the <a href="er-design-reports-openxml-2016-11.html">Design a configuration for generating reports in OPENXML format</a> task guide.</p>
<p>You must also download and locally save the following templates for the sample report:</p>
<ul>
<li><a href="https://go.microsoft.com/fwlink/?linkid=862266">Template of Payment Report (SampleVendPaymDocReport.docx)</a></li>
<li><a href="https://go.microsoft.com/fwlink/?linkid=862266">Bounded Template of Payment Report (SampleVendPaymDocReportBounded.docx)</a></li>
</ul>
<p>These procedures are for a feature that was added in Dynamics 365 for Operations version 1611 (November 2016).</p>
<h2 id="select-the-existing-er-report-configuration">Select the existing ER report configuration</h2>
<ol>
<li><p>In Dynamics 365 Finance, go to <strong>Organization administration</strong> &gt; <strong>Workspaces</strong> &gt; <strong>Electronic reporting</strong>.</p>
</li>
<li><p>Make sure that the <strong>Litware, Inc.</strong> configuration provider is selected as <strong>Active</strong>. If it isn't, follow the steps in the <a href="er-configuration-provider-mark-it-active-2016-11.html">Create configuration providers and mark them as active</a> task guide.</p>
</li>
<li><p>Select <strong>Reporting configurations</strong>. You will reuse the existing ER configuration that was designed to generate the report output in OPENXML format.</p>
</li>
<li><p>On the <strong>Configurations</strong> page, in the configuration tree in the left pane, expand <strong>Payment model</strong>, and select <strong>Sample worksheet report</strong>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>The draft version of the selected ER format can be edited on the <strong>Versions</strong> FastTab.</p>
</div>
</li>
<li><p>Select <strong>Designer</strong>.</p>
</li>
<li><p>On the <strong>Format designer</strong> page, notice that the title of the root format element indicates that an Excel template is currently used.</p>
</li>
</ol>
<p><img src="../media/er-design-configuration-word-2016-11-image01.gif" alt="Selecting the existing configuration"></p>
<h2 id="review-the-downloaded-word-template">Review the downloaded Word template</h2>
<ol>
<li>In the Word desktop application, open the <strong>SampleVendPaymDocReport.docx</strong> template file that you downloaded earlier.</li>
<li>Verify that the template contains only the layout of the document that you want to generate as ER output.</li>
</ol>
<p><img src="../media/er-design-configuration-word-2016-11-image02.png" alt="The Word template layout in the desktop application"></p>
<h2 id="replace-the-excel-template-with-the-word-template-and-add-a-custom-xml-part">Replace the Excel template with the Word template and add a custom XML part</h2>
<p>Currently, the Excel document is used as a template to generate the output in OPENXML format. You will replace this template with the SampleVendPaymDocReport.docx Word template file that you downloaded earlier. You will also extend the Word template by adding a custom XML part.</p>
<ol>
<li><p>In Finance, on the <strong>Format designer</strong> page, on the <strong>Format</strong> tab, select <strong>Attachments</strong>.</p>
</li>
<li><p>On the <strong>Attachments</strong> page, select <strong>Delete</strong> to remove the existing Excel template. Select <strong>Yes</strong> to confirm the change.</p>
</li>
<li><p>Select <strong>New</strong> &gt; <strong>File</strong>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You must select a document type that has been <a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/dev-itpro/analytics/electronic-reporting-er-configure-parameters">configured (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a> in the ER parameters to store templates of ER formats.</p>
</div>
</li>
<li><p>Select <strong>Browse</strong>, and then browse to and select the <strong>SampleVendPaymDocReport.docx</strong> file that you downloaded earlier.</p>
</li>
<li><p>Select <strong>OK</strong>.</p>
</li>
<li><p>Close the <strong>Attachments</strong> page.</p>
</li>
<li><p>On the <strong>Format designer</strong> page, in the <strong>Template</strong> field, enter or select the <strong>SampleVendPaymDocReport.docx</strong> file to use that Word template instead of the Excel template that was previously used.</p>
</li>
<li><p>Select <strong>Save</strong>.</p>
<p>In addition to storing configuration changes, the <strong>Save</strong> action updates the attached Word template. The hierarchical structure of the designed format is added to the attached Word document as a new custom XML part that is named <strong>Report</strong>. The attached Word template contains the layout of the document that will be generated as ER output and the structure of data that ER will enter in that template at runtime.</p>
</li>
<li><p>Notice that the title of the root format element indicates that a Word template is currently used.</p>
<p><img src="../media/er-design-configuration-word-2016-11-image03.gif" alt="Replacing the Excel template with the Word template and adding a custom XML part"></p>
</li>
<li><p>On the <strong>Format</strong> tab, select <strong>Attachments</strong>.</p>
</li>
</ol>
<p>You can now map the elements of the <strong>Report</strong> custom XML part to the content controls of the Word document.</p>
<p>If you're familiar with the process of designing Word documents as forms that contain <a href="https://docs.microsoft.com/office/client-developer/word/content-controls-in-word">content controls</a> that are mapped to elements of <a href="https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019">custom XML parts</a>, complete all steps in the next procedure to create the document. For more information, see <a href="https://support.office.com/article/Create-forms-that-users-complete-or-print-in-Word-040c5cc1-e309-445b-94ac-542f732c8c8b">Create forms that users complete or print in Words</a>. Otherwise, skip the next procedure.</p>
<h2 id="get-a-word-document-that-has-a-custom-xml-part-and-do-data-mapping"><a id='get-word-doc'></a>Get a Word document that has a custom XML part and do data mapping</h2>
<ol>
<li><p>In Finance, on the <strong>Attachments</strong> page, select <strong>Open</strong> to download the selected template from Finance and store it locally as a Word document.</p>
</li>
<li><p>In the Word desktop application, open the document that you just downloaded.</p>
</li>
<li><p>On the <strong>Developer</strong> tab, select <strong>XML Mapping Pane</strong>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>If the <strong>Developer</strong> tab doesn't appear on the ribbon, customize the ribbon to add it.</p>
</div>
</li>
<li><p>In the <strong>XML Mapping</strong> pane, in the <strong>Custom XML Part</strong> field, select the <strong>Report</strong> custom XML part.</p>
</li>
<li><p>Map the elements of the selected <strong>Report</strong> custom XML part and the content controls of the Word document.</p>
</li>
<li><p>Save the updated Word document locally as <strong>SampleVendPaymDocReportBounded.docx</strong>.</p>
</li>
</ol>
<h2 id="review-the-word-template-where-the-custom-xml-part-is-mapped-to-content-controls">Review the Word template where the custom XML part is mapped to content controls</h2>
<ol>
<li>In the Word desktop application, open the <strong>SampleVendPaymDocReportBounded.docx</strong> template file.</li>
<li>Verify that the template contains the layout of the document that you want to generate as ER output. The content controls that are used as placeholders for data that ER will enter in this template at runtime are based on the mappings that are configured between elements of the <strong>Report</strong> custom XML part and the content controls of the Word document.</li>
</ol>
<p><img src="../media/er-design-configuration-word-2016-11-image04.png" alt="Word template preview in the desktop application"></p>
<h2 id="upload-the-word-template-where-the-custom-xml-part-is-mapped-to-content-controls">Upload the Word template where the custom XML part is mapped to content controls</h2>
<ol>
<li><p>In Finance, on the <strong>Attachments</strong> page, select <strong>Delete</strong> to remove the Word template that has no mappings between elements of the <strong>Report</strong> custom XML part and content controls. Select <strong>Yes</strong> to confirm the change.</p>
</li>
<li><p>Select <strong>New</strong> &gt; <strong>File</strong> to add a new template file that contains mappings between elements of the <strong>Report</strong> custom XML part and content controls.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You must select a document type that has been <a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/dev-itpro/analytics/electronic-reporting-er-configure-parameters">configured (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a> in the ER parameters to store templates of ER formats.</p>
</div>
</li>
<li><p>Select <strong>Browse</strong>, and then browse to and select the <strong>SampleVendPaymDocReportBounded.docx</strong> file that you downloaded or prepared by completing the procedure in the <a href="#get-word-doc">Get a Word that has a custom XML part to do data mapping</a> section.</p>
</li>
<li><p>Select <strong>OK</strong>.</p>
</li>
<li><p>Close the <strong>Attachments</strong> page.</p>
</li>
<li><p>On the <strong>Format designer</strong> page, in the <strong>Template</strong> field, select the document that you just downloaded.</p>
</li>
<li><p>Select <strong>Save</strong>.</p>
</li>
<li><p>Close the <strong>Format designer</strong> page.</p>
</li>
</ol>
<h2 id="mark-the-configured-format-as-runnable">Mark the configured format as runnable</h2>
<p>To run the draft version of the editable format, you must make it <a href="../er-quick-start2-customize-report.html#MarkFormatRunnable">runnable</a>.</p>
<ol>
<li>In Finance, on the <strong>Configurations</strong> page, on the Action Pane, on the <strong>Configurations</strong> tab, in the <strong>Advanced settings</strong> group, select <strong>User parameters</strong>.</li>
<li>In the <strong>User parameters</strong> dialog box, set the <strong>Run settings</strong> option to <strong>Yes</strong>, and then select <strong>OK</strong>.</li>
<li>Select <strong>Edit</strong> to make the current page editable, as required.</li>
<li>For the currently selected <strong>Sample worksheet report</strong> configuration, set the <strong>Run Draft</strong> option to <strong>Yes</strong>.</li>
<li>Select <strong>Save</strong>.</li>
</ol>
<h2 id="run-the-format-to-create-output-in-word-format">Run the format to create output in Word format</h2>
<ol>
<li><p>In Finance, go to <strong>Accounts payable</strong> &gt; <strong>Payments</strong> &gt; <strong>Payment journal</strong>.</p>
</li>
<li><p>In a payment journal that you entered earlier, select <strong>Lines</strong>.</p>
</li>
<li><p>On the <strong>Vendor payments</strong> page, select all rows in the grid.</p>
</li>
<li><p>Select <strong>Payment status</strong> &gt; <strong>None</strong>.</p>
<p><img src="../media/er-design-configuration-word-2016-11-image05.png" alt="Payments for processing on the Vendor payments page"></p>
</li>
<li><p>On the Action Pane, select <strong>Generate payments</strong>.</p>
</li>
<li><p>In the dialog box that appears, follow these steps:</p>
<ol>
<li>In the <strong>Method of payment</strong> field, select <strong>Electronic</strong>.</li>
<li>In the <strong>Bank account</strong> field, select <strong>GBSI OPER</strong>.</li>
<li>Select <strong>OK</strong>.</li>
</ol>
</li>
<li><p>In the <strong>Electronic report parameters</strong> dialog box, select <strong>OK</strong>.</p>
</li>
<li><p>The generated output is presented in Word format and contains the details of the processed payments. Analyze the generated output.</p>
<p><img src="../media/er-design-configuration-word-2016-11-image06.png" alt="Generated output in Word format"></p>
</li>
</ol>
<h2 id="additional-resources">Additional resources</h2>
<ul>
<li><a href="../er-design-configuration-word.html">Design a new ER configuration to generate reports in Word format</a></li>
<li><a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/dev-itpro/analytics/electronic-reporting-embed-images-shapes">Embed images and shapes in documents that you generate by using ER (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a></li>
</ul>
</article>
              </div>
              
<div class="hidden-sm col-md-3" role="complementary">
  <div class="sideaffix">
    <div class="contribution">
      <ul class="nav">
        <li>
          <a href="https://github.com/MicrosoftDocs/Dynamics-365-unified-Operations-public/blob/live/articles/fin-ops-core/dev-itpro/analytics/tasks/er-design-configuration-word-2016-11.md/#L1" class="contribution-link">Improve this Doc</a>
        </li>
      </ul>
    </div>
    <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
    <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
    </nav>
  </div>
</div>

            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright � 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
