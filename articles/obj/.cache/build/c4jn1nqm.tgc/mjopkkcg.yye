<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Budget planning templates for Excel </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Budget planning templates for Excel ">
    <meta name="generator" content="docfx 2.56.6.0">
    <meta name="description" content="This topic describes how to create Microsoft Excel templates that can be used with budget plans.">
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="">
    <meta property="docfx:tocrel" content="../TOC.html">
    <meta name="searchOption" content="noindex">
    
    
    <meta name="robots" content="NOINDEX, NOFOLLOW">
    <meta name="ms.search.form" content="BudgetPlanSetLayout">
    <meta name="ms.search.scope" content="Core, Operations, Finance, ShowInHelp">
    <meta name="ms.search.region" content="Global">
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="row">
          <div class="col-sm-12">
            
<div class="sidenav hide-when-search"> 
  <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
  <div class="sidetoggle collapse" id="sidetoggle">
    <div id="sidetoc"></div>
  </div>
</div>
            <div class="row toc-offset">
              
              <div class="col-sm-12 col-md-9">
                <article class="article" id="_content" data-uid="">
<h1 id="budget-planning-templates-for-excel">Budget planning templates for Excel</h1>


<p>This topic describes how to create Microsoft Excel templates that can be used with budget plans.</p>
<p>This topic shows how to create Excel templates that will be used with budget plans using the standard demo data set and the Admin user login. For more information about budget planning, see <a href="budget-planning-overview-configuration.html">Budget planning overview</a>.
You can also follow the <a href="budget-plan.html">Budget planning</a> tutorial to learn basic module configuration and usage principles.</p>
<h2 id="generate-a-worksheet-using-budget-plan-document-layout">Generate a worksheet using budget plan document layout</h2>
<p>Budget plan documents can be viewed and edited using one or more layouts. Each layout can have an associated budget plan document template to view and edit the budget plan data in an Excel worksheet. In this topic, a budget plan document template will be generated using an existing layout configuration.</p>
<ol>
<li><p>Open the <strong>Budget plans list</strong> (<strong>Budgeting</strong> &gt; <strong>Budget plans</strong>).</p>
</li>
<li><p>Click <strong>New</strong> to create a new budget plan document.</p>
<p><a href="media/bpt11.png"><img src="media/bpt11-1024x552.png" alt="Budget plans list"></a></p>
</li>
<li><p>Use the <strong>Add</strong> line option to add lines. Click <strong>Layouts</strong> to view the budget plan document layout configuration.</p>
<p><a href="media/bpt2.png"><img src="media/bpt2-1024x274.png" alt="Budget plans add"></a></p>
</li>
</ol>
<p>You can review the layout configuration and adjust it as needed.</p>
<ol>
<li>Go to <strong>Template</strong> &gt; <strong>Generate</strong> to create an Excel file for this layout.</li>
<li>After the template is generated, go to <strong>Template</strong> &gt; <strong>View</strong> to open and review the budget plan document template. You can save the Excel file to your local drive.</li>
</ol>
<p><a href="media/bpt3.png"><img src="media/bpt3-1024x545.png" alt="Save as"></a></p>
<div class="NOTE">
<h5>Note</h5>
<p>The Budget plan document layout cannot be edited after an Excel template is associated with it. To modify the layout, delete the associated Excel template file and regenerate it. This is required to keep the fields in the layout and the worksheet synchronized.</p>
</div>
<p>The Excel template will contain all of the elements from the budget plan document layout, where the <strong>Available in Worksheet</strong> column is set to True. Overlapping elements are not allowed in the Excel template. For example, if the layout contains Request Q1, Request Q2, Request Q3, and Request Q4 columns, and a total request column that represents a sum of all 4 quarterly columns, only the quarterly columns or total column is available to be used in the Excel template. The Excel file cannot update overlapping columns during the update because data in the table could become out of date and inaccurate.</p>
<div class="NOTE">
<h5>Note</h5>
<p>To avoid potential issues with viewing and editing budget plan data using Excel, the same user should be logged into both Microsoft Dynamics 365 Finance and the Microsoft Dynamics Office Add-in Data Connector.</p>
</div>
<h2 id="add-a-header-to-budget-plan-document-template">Add a header to budget plan document template</h2>
<p>To add header information, select the top row in the Excel file and insert empty rows. Click <strong>Design</strong> in the <strong>Data Connector</strong> to add header fields to the Excel file.</p>
<p>In the <strong>Design</strong> tab, click <strong>Add</strong> fields, and then select <strong>BudgetPlanHeader</strong> as the entity data source.</p>
<p>Point the cursor to the desired location in the Excel file. Click <strong>Add label</strong> to add the field label to the selected location. Select <strong>Add Value</strong> to add the value field to the selected place. Click <strong>Done</strong> to close the designer.</p>
<h2 id="select-add-value"><a href="media/bpt7.png"><img src="media/bpt7.png" alt="Select Add Value"></a></h2>
<h2 id="add-a-calculated-column-to-budget-plan-document-template-table">Add a calculated column to budget plan document template table</h2>
<p>Next, calculated columns will be added to generated budget plan document template. A <strong>Total request</strong> column, which summarizes Request Q1: Request Q4 columns, and an <strong>Adjustment</strong> column, which recalculates the <strong>Total Request</strong> column by a predefined factor.</p>
<p>Click <strong>Design</strong> in the <strong>Data connector</strong> to add columns to the table. Click <strong>Edit</strong> next to <strong>BudgetPlanWorksheet</strong> data source to start adding columns.</p>
<p><a href="media/bpt8.png"><img src="media/bpt8-1024x301.png" alt="Start adding columns"></a></p>
<p>The selected field group displays the columns that are available in the template. Click <strong>Formula</strong> to add a new column. Name the new column and then paste the formula into the <strong>Formula</strong> field. Click <strong>Update</strong> to insert the column.</p>
<p><a href="media/bpt12.png"><img src="media/bpt12-1024x565.png" alt="Add and insert column"></a></p>
<div class="NOTE">
<h5>Note</h5>
<p>To define the formula, create the formula in the spreadsheet, and then copy it to the <strong>Design</strong> window. A Finance and Operations bound table will typically be named &quot;AXTable1&quot;. For example, to summarize Request Q1 : Request Q4 columns in the spreadsheet, the formula = AxTable1[Request Q1]+AxTable1[Request Q2]+AxTable1[Request Q3]+AxTable1[Request Q4].</p>
</div>
<p>Repeat these steps to insert the <strong>Adjustment</strong> column. Use formula = AxTable1[Total request]*$I$1 for this column. This will take the value in cell I1 and multiply the values in the <strong>Total request</strong> column to calculate adjustment amounts.</p>
<p>Save and close the Excel file. In <strong>Layouts</strong>, click <strong>Template &gt; Upload</strong> to upload the saved Excel template to be used for the budget plan.</p>
<p><a href="media/bpt10.png"><img src="media/bpt10-1024x352.png" alt="Upload Excel template"></a></p>
<p>Close the <strong>Layouts</strong> slider. In <strong>Budget plan</strong> document, click <strong>Worksheet</strong> to view and edit the document in Excel. Note that the adjusted Excel template was used to create this budget plan worksheet and calculated columns are updated using the formulas that were defined in the previous steps.</p>
<p><a href="media/bpt111.png"><img src="media/bpt111-1024x431.png" alt="View and edit document in Excel"></a></p>
<h2 id="tips--tricks-for-creating-budget-plan-templates">Tips &amp; tricks for creating budget plan templates</h2>
<h3 id="can-i-add-and-use-additional-data-sources-to-a-budget-plan-template">Can I add and use additional data sources to a budget plan template?</h3>
<p>Yes, you can use the <strong>Design</strong> menu to add additional entities to the same or other sheets in the Excel template. For example, you can add the <strong>BudgetPlanProposedProject</strong> data source to create and maintain a list of proposed projects at the same time when working with budget plan data in Excel. Note that including high-volume data sources might impact performance of the Excel workbook.</p>
<p>You can use the <strong>Filter</strong> option in the <strong>Data Connector</strong> to add desired filters to additional data sources.</p>
<h3 id="can-i-hide-the-design-option-in-the-data-connector-for-other-users">Can I hide the Design option in the Data connector for other users?</h3>
<p>Yes, open the <strong>Data Connector</strong> options to hide the <strong>Design</strong> option from other users.</p>
<p><a href="media/bpt13.png"><img src="media/bpt13-1024x565.png" alt="Open Data Connector options"></a></p>
<p>Expand <strong>Data connector options</strong> and clear the <strong>Enable design</strong> check box. This will hide the <strong>Design</strong> option from the <strong>Data connector</strong>.</p>
<p><a href="media/bpt14.png"><img src="media/bpt14-1024x592.png" alt="Hide Design option from Data connector"></a></p>
<h3 id="can-i-prevent-users-from-accidently-closing-the-data-connector-while-working-with-data">Can I prevent users from accidently closing the Data connector while working with data?</h3>
<p>We recommend locking the template to prevent users from closing it. To turn on the lock, click the <strong>Data connector</strong>, in the top right corner an arrow appears.</p>
<p><a href="media/bpt15.png"><img src="media/bpt15-1024x285.png" alt="Turn on the lock"></a></p>
<p>Click the arrow for an additional menu. Select <strong>Lock</strong>.</p>
<h3 id="select-lock"><a href="media/bpt16.png"><img src="media/bpt16-1024x614.png" alt="Select Lock"></a></h3>
<h3 id="can-i-use-other-excel-features-like-cell-formatting-colors-conditional-formatting-and-charts-with-my-budget-plan-templates">Can I use other Excel features, like cell formatting, colors, conditional formatting, and charts with my budget plan templates?</h3>
<p>Yes, most of the standard Excel capabilities will work in budget plan templates. We recommend using color-coding for users to distinguish between read-only and editable columns. Conditional formatting can be used to highlight problematic areas of the budget. Column totals can easily be presented by using standard Excel formulas above the table.</p>
<p>You can also create and use pivot tables and charts for additional groupings and visualizations of budget data. On the <strong>Data</strong> tab, in the <strong>Connections</strong> group, click <strong>Refresh All</strong>, and then click <strong>Connection Properties</strong>. Click the <strong>Usage</strong> tab. Under <strong>Refresh</strong>, select the <strong>Refresh data when opening the file</strong> check box.</p>
</article>
              </div>
              
<div class="hidden-sm col-md-3" role="complementary">
  <div class="sideaffix">
    <div class="contribution">
      <ul class="nav">
        <li>
          <a href="https://github.com/MicrosoftDocs/Dynamics-365-unified-Operations-public/blob/live/articles/finance/budgeting/budget-planning-excel-templates.md/#L1" class="contribution-link">Improve this Doc</a>
        </li>
      </ul>
    </div>
    <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
    <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
    </nav>
  </div>
</div>

            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright � 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
