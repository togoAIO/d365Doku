<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Configure data import from SharePoint </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Configure data import from SharePoint ">
    <meta name="generator" content="docfx 2.56.6.0">
    <meta name="description" content="This topic explains how to import data from Microsoft SharePoint.">
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="">
    <meta property="docfx:tocrel" content="../../../commerce/TOC.html">
    <meta name="searchOption" content="noindex">
    
    
    <meta name="robots" content="NOINDEX, NOFOLLOW">
    
    <meta name="ms.search.scope" content="Core, Operations, CrossApp, ShowInHelp">
    <meta name="ms.search.region" content="Global">
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="row">
          <div class="col-sm-12">
            
<div class="sidenav hide-when-search"> 
  <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
  <div class="sidetoggle collapse" id="sidetoggle">
    <div id="sidetoc"></div>
  </div>
</div>
            <div class="row toc-offset">
              
              <div class="col-sm-12 col-md-9">
                <article class="article" id="_content" data-uid="">
<h1 id="configure-data-import-from-sharepoint">Configure data import from SharePoint</h1>


<p>To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the <strong>To destination</strong> type that uses that format as a data source. To import data, you must navigate to the file that you want to import. The incoming file can be manually selected by user. With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended. You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders. This topic explains how to complete the import from SharePoint. The examples use vendor transactions as business data.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>To complete the examples in this topic, you must have the following access:</p>
<ul>
<li><p>Access one of the following roles:</p>
<ul>
<li>Electronic reporting developer</li>
<li>Electronic reporting functional consultant</li>
<li>System administrator</li>
</ul>
</li>
<li><p>Access to the instance of Microsoft SharePoint Server that is configured for use with the application.</p>
</li>
<li><p>ER format and model configurations for 1099 payments.</p>
</li>
</ul>
<h3 id="create-required-er-configurations">Create required ER configurations</h3>
<p>Play the <strong>ER Import data from a Microsoft Excel file</strong> task guides, which are part of the <strong>7.5.4.3 Acquire/Develop IT service/solution components (10677)</strong> business process. These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files. For more information, see <a href="parse-incoming-documents-excel.html">Parse incoming documents in Excel format</a>. After you have completed the task guides, you will have the following setup.</p>
<h4 id="er-configurations">ER configurations</h4>
<ul>
<li>ER model configuration, <strong>1099 Payments model</strong></li>
<li>ER format configuration, <strong>Format for importing vendors' transactions from Excel</strong></li>
</ul>
<p><img src="media/GERImportFromSharePoint-01-Configurations.PNG" alt="ER configurations for importing data from SharePoint"></p>
<h4 id="sample-of-the-incoming-file-for-data-import">Sample of the incoming file for data import</h4>
<ul>
<li>Excel file <strong>1099import-data.xlsx</strong>, with vendor transactions that should be imported.</li>
</ul>
<p><img src="media/GERImportFromSharePoint-02-Excel.PNG" alt="Sample  Excel file for importing from SharePoint"></p>
<div class="NOTE">
<h5>Note</h5>
<p>The format for importing vendor transactions is selected as the default model mapping. Therefore, if you run a model mapping of the <strong>1099 Payments model</strong>, and that model mapping is of the <strong>To destination</strong> type, the model mapping runs this format to import data from external files. It then uses that data to update application tables.</p>
</div>
<h2 id="configure-access-to-sharepoint-for-file-storage">Configure access to SharePoint for file storage</h2>
<p>To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company. In this example, the company is USMF. For instructions, see <a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/fin-ops/organization-administration/configure-document-management">Configure SharePoint storage (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a>.</p>
<ol>
<li><p>Complete the steps in <a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/fin-ops/organization-administration/configure-document-management">Configure SharePoint storage (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a>.</p>
</li>
<li><p>Open the configured SharePoint site.</p>
</li>
<li><p>Create the following folders where incoming electronic reporting files can be stored:</p>
<ul>
<li>Files import source (main) (Example shown in screenshot below)</li>
<li>Files import source (alternative)</li>
</ul>
<p><img src="media/GERImportFromSharePoint-04-SharePointFolder1.png" alt="Files import source (main)"></p>
</li>
<li><p>(Optional) Create the following folders where the files can be stored after import.</p>
<ul>
<li>Files archive folder - This folder would be for successfully imported files.</li>
<li>Files warning folder - This folder would be for files that were imported with a warning.</li>
<li>Files error folder - This folder would be for files that failed to import.</li>
</ul>
</li>
<li><p>Go to <strong>Organization administration &gt; Document management &gt; Document types</strong>.</p>
</li>
<li><p>Create the following document types that will be used to access the SharePoint folders that you created. For instructions, see <a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/fin-ops/organization-administration/configure-document-management">Configure document types (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a>.</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>Document type</th>
<th>Group</th>
<th>Location</th>
<th>SharePoint folder</th>
</tr>
</thead>
<tbody>
<tr>
<td>SP Main</td>
<td>File</td>
<td>SharePoint</td>
<td>Files import source (main)</td>
</tr>
<tr>
<td>SP Alternative</td>
<td>File</td>
<td>SharePoint</td>
<td>Files import source (alternative)</td>
</tr>
<tr>
<td>SP Archive</td>
<td>File</td>
<td>SharePoint</td>
<td>Files archive folder</td>
</tr>
<tr>
<td>SP Warning</td>
<td>File</td>
<td>SharePoint</td>
<td>Files warning folder</td>
</tr>
<tr>
<td>SP Error</td>
<td>File</td>
<td>SharePoint</td>
<td>Files error folder</td>
</tr>
</tbody>
</table>
<p><img src="media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png" alt="SharePoint setting – new document type"></p>
<h2 id="configure-er-sources-for-the-er-format">Configure ER sources for the ER format</h2>
<ol>
<li><p>Click <strong>Organization administration</strong> &gt; <strong>Electronic reporting</strong> &gt; <strong>Electronic reporting source</strong>.</p>
</li>
<li><p>On the <strong>Electronic reporting source</strong> page, configure the source files for data import by using the configured ER format.</p>
</li>
<li><p>Define a file name mask, so that only files with the .xlsx extension are imported. The file name mask is optional and is used only when it has been defined. You can define only one mask for each ER format.</p>
</li>
<li><p>Change <strong>Sort files before import</strong> to <strong>Do not sort</strong>, if there are several files for import and the import order is not important</p>
</li>
<li><p>Select all SharePoint folders that you created earlier.</p>
<p><a href="media/GERImportFromSharePoint-07-FormatSourceSetup.PNG"><img src="media/GERImportFromSharePoint-07-FormatSourceSetup.PNG" alt="ER files source setting"></a></p>
</li>
</ol>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>The ER <em>source</em> is defined for each application company individually. By contrast, ER <em>configurations</em> are shared across companies.</li>
<li>When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</li>
</ul>
</div>
<h2 id="review-the-files-states-for-the-er-format">Review the files states for the ER format</h2>
<ol>
<li><p>On the <strong>Electronic reporting source</strong> page, select <strong>File states for the sources</strong> to review the content of the configured file sources for the current ER format.</p>
</li>
<li><p>In the <strong>Files</strong> section, review the list of files. This list presents the following:</p>
<ul>
<li>Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import. For these files, the <strong>Sources log for the import format</strong> section is blank.</li>
<li>Previously imported files. For each of these files, in the <strong>Sources log for the import format</strong> section, you can review the history of import of this file.</li>
</ul>
</li>
</ol>
<p>You can also open the <strong>File states for the sources</strong> page by selecting <strong>Organization administration</strong> &gt; <strong>Electronic reporting</strong> &gt; <strong>File states for the sources</strong>. In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</p>
<h2 id="import-data-from-excel-files-that-are-in-a-sharepoint-folder">Import data from Excel files that are in a SharePoint folder</h2>
<ol>
<li><p>In SharePoint, upload the Microsoft Excel file <strong>1099import-data.xlsx</strong> that contains vendor transactions to the <strong>Files import source (main)</strong> SharePoint folder that you created earlier.</p>
<p><a href="media/GERImportFromSharePoint-08-UploadFile.png"><img src="media/GERImportFromSharePoint-08-UploadFile.png" alt="SharePoint content – Microsoft Excel file for importing"></a></p>
</li>
<li><p>On the <strong>File states for the sources</strong> page, select <strong>Refresh</strong> to refresh the page. The Excel file that was uploaded to SharePoint appeared on this page with the status <strong>Ready</strong>. The following statuses are currently supported:</p>
<ul>
<li><strong>Ready</strong> – Assigned automatically for each new file in a SharePoint folder. This status means that the file is ready for import.</li>
<li><strong>Importing</strong> – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</li>
<li><strong>Imported</strong> – Assigned automatically by an ER report when the file import is successfully completed. This status means that the imported file has been deleted from the configured files source (SharePoint folder).</li>
<li><strong>Failed</strong> – Assigned automatically by an ER report when the file import completed with errors or exceptions.</li>
<li><strong>On hold</strong> – Assigned manually by user on this page. This status means that the file will not be imported for now. This status can be used to postpone the import of some files.</li>
</ul>
<p><a href="media/GERImportFromSharePoint-09-FileStatesForm.png"><img src="media/GERImportFromSharePoint-09-FileStatesForm.png" alt="Refreshed ER file states page for the selected sources"></a></p>
</li>
</ol>
<h2 id="import-data-from-sharepoint-files">Import data from SharePoint files</h2>
<ol>
<li><p>Open the ER configurations tree, select the <strong>1099 Payment model</strong>, and expand the list of ER model components.</p>
</li>
<li><p>Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</p>
<p><a href="media/GERImportFromSharePoint-10-SelectModelMapping.PNG"><img src="media/GERImportFromSharePoint-10-SelectModelMapping.PNG" alt="Configuration page"></a></p>
</li>
<li><p>Select <strong>Run</strong> to run the selected model mapping. Because you configured file sources for the ER format, you can change the setting of the <strong>File source</strong> option, if needed. If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</p>
<p>In this example, you're importing only one file. However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder. Every run of an ER format imports a single selected file.</p>
<p><a href="media/GERImportFromSharePoint-11-RunModelMapping.PNG"><img src="media/GERImportFromSharePoint-11-RunModelMapping.PNG" alt="Import from SharePoint and run ER model mapping"></a></p>
</li>
<li><p>The model mapping can run <a href="#limitations">unattended</a> in batch mode. In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</p>
<p>When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings. Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</p>
</li>
<li><p>Enter the voucher ID, such as <strong>V-00001</strong>, and then select <strong>OK</strong>.</p>
<p><a href="media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG"><img src="media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG" alt="Run ER model mapping"></a></p>
</li>
<li><p>On the <strong>File states for the sources</strong> page, select <strong>Refresh</strong> to refresh the page.</p>
<p><a href="media/GERImportFromSharePoint-13-FileStatesForm.PNG"><img src="media/GERImportFromSharePoint-13-FileStatesForm.PNG" alt="ER file states for the sources page"></a></p>
</li>
<li><p>In the <strong>Files</strong> section, review the list of files. The <strong>Sources log for the import format</strong> section provides the history of the Excel file import. Because this file was successfully imported, it's marked as <strong>Deleted</strong> in the SharePoint folder.</p>
</li>
<li><p>Review the <strong>Files import source (main)</strong> SharePoint folder. The Excel files that were successfully imported have been deleted from this folder.</p>
</li>
<li><p>Select <strong>Accounts payable</strong> &gt; <strong>Periodic tasks</strong> &gt; <strong>Tax 1099</strong> &gt; <strong>Vendor settlement for 1099s</strong>.</p>
</li>
<li><p>In the <strong>From date</strong> and <strong>To date</strong> fields, enter appropriate values. Then select <strong>Manual 1099 transactions</strong>.</p>
<p>The vendor transactions that were imported from the Excel files on SharePoint for voucher <strong>V-00001</strong>, are presented on the page.</p>
<p><a href="media/GERImportFromSharePoint-14-ImportedTransactions.PNG"><img src="media/GERImportFromSharePoint-14-ImportedTransactions.PNG" alt="1099 vendor transactions page"></a></p>
</li>
</ol>
<h2 id="prepare-an-excel-file-for-import">Prepare an Excel file for import</h2>
<ol>
<li><p>Open the Excel file that you previously used. In row 3 column 1, add a vendor code that doesn't exist in the application. Add additional false vendor information to the row.</p>
<p><a href="media/GERImportFromSharePoint-15-Excel.PNG"><img src="media/GERImportFromSharePoint-15-Excel.PNG" alt="Sample Microsoft Excel file for importing from SharePoint"></a></p>
</li>
<li><p>Upload the updated Excel file that contains vendors transactions to the <strong>Files import source (main)</strong> SharePoint folder.</p>
</li>
<li><p>Open the ER configurations tree, select the <strong>1099 Payment model</strong>, and expand the list of ER model components.</p>
</li>
<li><p>Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</p>
</li>
<li><p>Select <strong>Designer</strong>.</p>
</li>
<li><p>On the <strong>Validations</strong> tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application. Update the value of the <strong>Post-validation action</strong> field to <strong>Stop execution</strong>, save your changes, and close the page.</p>
<p><a href="media/GERImportFromSharePoint-16-UpdateModelMapping.PNG"><img src="media/GERImportFromSharePoint-16-UpdateModelMapping.PNG" alt="ER model mapping designer page"></a></p>
</li>
<li><p>Save your changes, and close the ER model mapping designer.</p>
</li>
<li><p>Select <strong>Run</strong> to run the modified ER model mapping.</p>
</li>
<li><p>Enter the voucher ID, such as <strong>V-00002</strong>, and then select <strong>OK</strong>.</p>
<p>The Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</p>
<p><a href="media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG"><img src="media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG" alt="Finished Run ER model mapping"></a></p>
</li>
<li><p>On the <strong>File states for the sources</strong> page, select <strong>Refresh</strong>, and then, in the <strong>Files</strong> section, review the list of files.</p>
<p><a href="media/GERImportFromSharePoint-18-FileStatesForm.PNG"><img src="media/GERImportFromSharePoint-18-FileStatesForm.PNG" alt="ER file states page for the selected sources"></a></p>
</li>
</ol>
<p>The <strong>Sources log for the import format</strong> section indicates that the import process failed and that the file is in the Files error SharePoint folder (the <strong>Is deleted</strong> check box is not selected). If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</p>
<ol start="11">
<li><p>Select <strong>Accounts payable</strong> &gt; <strong>Periodic tasks</strong> &gt; <strong>Tax 1099</strong> &gt; <strong>Vendor settlement for 1099s</strong>, enter appropriate values in the <strong>From date</strong> and <strong>To date</strong> fields, and then select <strong>Manual 1099 transactions</strong>.</p>
<p>Only transactions for voucher V-00001 are available. No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</p>
</li>
</ol>
<h2 id="limitations"><a name="limitations">Limitations</a></h2>
<p>The ER framework doesn't offer the capability to initiate a new batch job that will execute a model mapping in unattended mode for data import. To do this, you must develop new logic so that the configured ER model mapping can be called from the application user interface (UI) to import data from inbound files. Therefore, some engineering work is required.</p>
<p>To learn more about the relevant ER API, see the <a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/dev-itpro/analytics/er-apis-app73">Code to run a format mapping for data import (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a> section in the <a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/dev-itpro/analytics/er-apis-app73">ER framework API changes for Application update 7.3 (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a> topic.</p>
<p>Review the code in the <code>BankImport_RU</code> class of the <code>Application Suite</code> model to see how your custom logic can be implemented. This class extends the <code>RunBaseBatch</code> class. In particular, review the <code>runER()</code> method where the <code>ERIModelMappingDestinationRun</code> object is created as the runner of an ER model mapping.</p>
<h2 id="additional-resources">Additional resources</h2>
<p><a href="general-electronic-reporting.html">Electronic Reporting overview</a></p>
<p><a href="https://docs.wika.com/en-us/dynamics365/supply-chain/fin-ops-core/dev-itpro/analytics/er-apis-app73">ER framework API changes for Application update 7.3 (This is an external linThis link was changed due to HTMLfromRepoGenerator)</a></p>
</article>
              </div>
              
<div class="hidden-sm col-md-3" role="complementary">
  <div class="sideaffix">
    <div class="contribution">
      <ul class="nav">
        <li>
          <a href="https://github.com/MicrosoftDocs/Dynamics-365-unified-Operations-public/blob/live/articles/fin-ops-core/dev-itpro/analytics/er-configure-data-import-sharepoint.md/#L1" class="contribution-link">Improve this Doc</a>
        </li>
      </ul>
    </div>
    <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
    <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
    </nav>
  </div>
</div>

            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright � 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
