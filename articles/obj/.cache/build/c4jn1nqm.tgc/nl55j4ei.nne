<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>ER Configure format to do counting and summing (Part 2 - Configure computations) </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="ER Configure format to do counting and summing (Part 2 - Configure computations) ">
    <meta name="generator" content="docfx 2.56.6.0">
    <meta name="description" content="The following steps explain how a user assigned to the system administrator or electronic reporting developer role can configure an Electronic reporting (ER) format to do counting and summing based on data of the already generated text output.">
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="">
    <meta property="docfx:tocrel" content="../../../../commerce/TOC.html">
    <meta name="searchOption" content="noindex">
    
    
    <meta name="robots" content="NOINDEX, NOFOLLOW">
    <meta name="ms.search.form" content="ERWorkspace, ERSolutionTable, ERSolutionCreateDropDialog, EROperationDesigner, ERDataSourceAddDropDialog, ERExpressionDesignerFormula">
    <meta name="ms.search.scope" content="Core, Operations, CrossApp, ShowInHelp">
    <meta name="ms.search.region" content="Global">
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="row">
          <div class="col-sm-12">
            
<div class="sidenav hide-when-search"> 
  <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
  <div class="sidetoggle collapse" id="sidetoggle">
    <div id="sidetoc"></div>
  </div>
</div>
            <div class="row toc-offset">
              
              <div class="col-sm-12 col-md-9">
                <article class="article" id="_content" data-uid="">
<h1 id="er-configure-format-to-do-counting-and-summing-part-2---configure-computations">ER Configure format to do counting and summing (Part 2 - Configure computations)</h1>


<p>The following steps explain how a user assigned to the system administrator or electronic reporting developer role can configure an Electronic reporting (ER) format to do counting and summing based on data of the already generated text output. These steps can be performed in any company.</p>
<p>To complete these steps, you must first complete the steps in the &quot;ER Configure format to do counting and summing (Part 1: Create format)&quot; procedure.</p>
<p>This procedure is for a feature that was added in Dynamics 365 for Operations version 1611.</p>
<h2 id="create-a-format-configuration-to-add-counting-and-summing-details">Create a format configuration to add counting and summing details</h2>
<ol>
<li>Go to Organization administration &gt; Workspaces &gt; Electronic reporting.</li>
<li>Click Reporting configurations.</li>
<li>In the tree, expand 'Intrastat model'.</li>
<li>In the tree, select 'Intrastat model\Intrastat (DE)'.
<ul>
<li>Assume that you need to customize the format provided by Microsoft by adding lines with summary details at the end of the Intrastat report. You need to do that by deriving our own instance of the Intrastat configuration from the Microsoft instance to make modifications.</li>
</ul>
</li>
<li>Click Create configuration to open the drop dialog.</li>
<li>In the New field, enter 'Derive from Name: Intrastat (DE), Microsoft'.</li>
<li>In the Name field, type 'Intrastat (DE) with counting &amp; summing'.</li>
<li>Click Create configuration.</li>
</ol>
<h2 id="configure-this-report-to-do-counting-and-summation-based-on-output-details">Configure this report to do counting and summation based on output details</h2>
<ol>
<li>Click Designer.</li>
<li>Select Yes in the Collect output details field.
<ul>
<li>This flag will activate at run-time the process of collecting output details for generating the Intrastat file.</li>
<li>You need to do counting for different Intrastat directions, so add a dedicated model enumeration to the data sources' list of this format configuration.</li>
</ul>
</li>
<li>Click the Mapping tab.</li>
<li>Click Add root to open the drop dialog.</li>
<li>In the tree, select 'Data model\Enumeration '.</li>
<li>In the Name field, type 'Direction'.</li>
<li>In the Model enumeration field, enter or select a value.
<ul>
<li>Select the value Direction.</li>
</ul>
</li>
<li>Click OK.</li>
<li>Click Add root to open the drop dialog.</li>
<li>In the tree, select 'Functions\Calculated field'.</li>
<li>In the Name field, type '$BlockName'.</li>
<li>Click Edit formula.</li>
<li>In the Formula field, enter '&quot;block&quot;'.</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>Click OK.</li>
<li>Click Add root to open the drop dialog.</li>
<li>In the tree, select 'Functions\Calculated field'.</li>
<li>In the Name field, type '$RecName'.</li>
<li>Click Edit formula.</li>
<li>In the Formula field, enter '&quot;record&quot;'.</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>Click OK.</li>
<li>Click Add root to open the drop dialog.</li>
<li>In the tree, select 'Functions\Calculated field'.</li>
<li>In the Name field, type '$InvName'.</li>
<li>Click Edit formula.</li>
<li>In the Formula field, enter '&quot;InvoicedAmountEUR&quot;'.</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>Click OK.</li>
<li>In the tree, select 'Intrastat\Data'.</li>
<li>Click Edit button for the 'Collected data key name' field</li>
<li>Click Add data source.
<ul>
<li>$BlockName</li>
</ul>
</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>Click the Edit button for the Collected data key value field.</li>
<li>In the Formula field, enter 'IF(Intrastat.CommodityRecord.Direction=Direction.Import, &quot;Import&quot;, &quot;Export&quot;)'.
<ul>
<li>IF(Intrastat.CommodityRecord.Direction=Direction.Import, &quot;Import&quot;, &quot;Export&quot;)</li>
</ul>
</li>
<li>Click Save.</li>
<li>Close the page.
<ul>
<li>Count the lines of this sequence. The results will be used with the name &quot;block&quot; separately for different directions. Value &quot;Import&quot; will be used for any arrivals Intrastat transactions. The value &quot;Export&quot; will be used for any Intrastat dispatches transactions. Consider this to be a virtual Excel spreadsheet. For each transaction a row where the first column &quot;block&quot; is filled with the values &quot;Import&quot; and &quot;Export&quot; accordingly.</li>
</ul>
</li>
<li>In the tree, expand 'Intrastat\Data: Sequence'.</li>
<li>In the tree, select 'Intrastat\Data: Sequence\Arrivals?'.</li>
<li>Click Edit button for the 'Collected data key name' field.
<ul>
<li>Count the lines of this sequence. The results will be memorized using the name &quot;record&quot;.</li>
</ul>
</li>
<li>In the tree, select '$RecName'.</li>
<li>Click Add data source.</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>Click Edit button for the 'Collected data key value' field</li>
<li>In the Formula field, enter 'Intrastat.CommodityRecord.CommodityCode'.</li>
<li>Click Save.</li>
<li>Close the page.
<ul>
<li>Count the lines of this sequence. The results will be used with the name &quot;record&quot; separately for different commodity codes. Consider this to be a virtual Excel spreadsheet. For each transaction a row where the first column &quot;block&quot; is filled with the values &quot;Import&quot; and &quot;Export&quot; accordingly and the second block &quot;record&quot; is filled with the commodity code value.</li>
</ul>
</li>
<li>In the tree, select 'Intrastat\Data: Sequence\Dispatches?'.</li>
<li>Click Edit button for the 'Collected data key name' field</li>
<li>In the tree, select '$RecName'.</li>
<li>Click Add data source.</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>Click the Edit button for the 'Collected data key value' field.</li>
<li>In the Formula field, enter 'Intrastat.CommodityRecord.CommodityCode'.</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>In the tree, expand 'Intrastat\Data: Sequence\Dispatches: Sequence?'.</li>
<li>In the tree, expand 'Intrastat\Data: Sequence\Dispatches: Sequence?\Record =  Intrastat.CommodityRecord'.</li>
<li>Click the Format tab.</li>
<li>In the tree, select 'Intrastat\Data\Dispatches\Record\Invoice amount EUR'.</li>
<li>Click the Mapping tab.</li>
<li>Click the Edit button for the 'Collected data key name' field.</li>
<li>In the tree, select '$InvName'.</li>
<li>Click Add data source.</li>
<li>Click Save.</li>
<li>Close the page.
<ul>
<li>Summarize the invoiced amount values for lines of this sequence. The results will be used with the name &quot;InvoicedAmountEUR&quot; separately for different Intrastat directions and commodity codes. Consider this to be a virtual creation in Excel spreadsheet. For each transaction a row where the first column &quot;block&quot; is filled with the values &quot;Import&quot; and &quot;Export&quot; accordingly. The second block &quot;record&quot; is filled with the commodity code value, and the third column &quot;InvoicedAmountEUR&quot; is filled with the invoice amount value.</li>
</ul>
</li>
<li>In the tree, expand 'Intrastat\Data\Arrivals?'.</li>
<li>In the tree, expand 'Intrastat\Data\Arrivals?\Record =  Intrastat.CommodityRecord'.</li>
<li>Click the Format tab.</li>
<li>In the tree, select 'Intrastat\Data\Arrivals\Record\Invoice amount EUR'.</li>
<li>Click the Mapping tab.</li>
<li>Click the Edit button for the 'Collected data key name' field.</li>
<li>In the tree, select '$InvName'.</li>
<li>Click Add data source.</li>
<li>Click Save.</li>
<li>Close the page.</li>
<li>Click Save.</li>
<li>Close the page.</li>
</ol>
</article>
              </div>
              
<div class="hidden-sm col-md-3" role="complementary">
  <div class="sideaffix">
    <div class="contribution">
      <ul class="nav">
        <li>
          <a href="https://github.com/MicrosoftDocs/Dynamics-365-unified-Operations-public/blob/live/articles/fin-ops-core/dev-itpro/analytics/tasks/er-format-counting-summing-2.md/#L1" class="contribution-link">Improve this Doc</a>
        </li>
      </ul>
    </div>
    <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
    <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
    </nav>
  </div>
</div>

            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright � 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
