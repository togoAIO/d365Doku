<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Troubleshoot issues related to upgrades of Finance and Operations apps </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Troubleshoot issues related to upgrades of Finance and Operations apps ">
    <meta name="generator" content="docfx 2.56.6.0">
    <meta name="description" content="This topic provides troubleshooting information that can help you fix issues that are related to upgrades of Finance and Operations apps.">
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="">
    <meta property="docfx:tocrel" content="../../toc.html">
    <meta name="searchOption" content="noindex">
    
    
    <meta name="robots" content="NOINDEX, NOFOLLOW">
    
    <meta name="ms.search.scope" content="Core, Operations, CrossApp, ShowInHelp">
    <meta name="ms.search.region" content="global">
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="row">
          <div class="col-sm-12">
            
<div class="sidenav hide-when-search"> 
  <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
  <div class="sidetoggle collapse" id="sidetoggle">
    <div id="sidetoc"></div>
  </div>
</div>
            <div class="row toc-offset">
              
              <div class="col-sm-12 col-md-9">
                <article class="article" id="_content" data-uid="">
<h1 id="troubleshoot-issues-related-to-upgrades-of-finance-and-operations-apps">Troubleshoot issues related to upgrades of Finance and Operations apps</h1>

[!include[rename-banner](~/includes/cc-data-platform-banner.md)]
<p>This topic provides troubleshooting information for dual-write integration between Finance and Operations apps and Dataverse. Specifically, it provides information that can help you fix issues that are related to upgrades of Finance and Operations apps.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Some of the issues that this topic addresses might require either the system admin role or Microsoft Azure Active Directory (Azure AD) tenant admin credentials. The section for each issue explains whether a specific role or credentials are required.</p>
</div>
<h2 id="database-synchronization-errors">Database synchronization errors</h2>
<p><strong>Required role to fix the issue:</strong> System admin</p>
<p>You might receive an error message that resembles the following example when you try to use the <strong>DualWriteProjectConfiguration</strong> table to update a Finance and Operations app to Platform update 30.</p>
<pre><code class="lang-console">Infolog diagnostic message: 'Cannot select a row in Dual write project sync (DualWriteProjectConfiguration). The SQL database has issued an error.' on category 'Error'. 10/28/2019 15:18:20: Infolog diagnostic message: 'Object Server Database Synchronizer: ' on category 'Error'. 10/28/2019 15:18:20: Infolog diagnostic message: '[Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'ISDELETE'.' on category 'Error'. 10/28/2019 15:18:20: Infolog diagnostic message: 'SELECT T1.PROJECTNAME,T1.EXTERNALENTITYNAME,T1.INTERNALENTITYNAME,T1.EXTERNALENVIRONMENTURL,T1.STATUS,T1.ENABLEBATCHLOOKUP,T1.PARTITIONMAP,T1.QUERYFILTEREXPRESSION,T1.INTEGRATIONKEY,T1.ISDELETE,T1.ISDEBUGMODE,T1.RECVERSION,T1.PARTITION,T1.RECID FROM DUALWRITEPROJECTCONFIGURATION T1 WHERE (PARTITION=5637144576)' on category 'Error'. 10/28/2019 15:18:20: Infolog diagnostic message: 'session 1043 (Admin)' on category 'Error'. 10/28/2019 15:18:20: Infolog diagnostic message: 'Stack trace: Call to TTSCOMMIT without first calling TTSBEGIN.' on category 'Error'.
10/28/2019 15:18:20: Application configuration sync failed.
Microsoft.Dynamics.AX.Framework.Database.TableSyncException: Custom action threw exception(s), please investigate before synchronizing again: 'InfoException:Stack trace: Call to TTSCOMMIT without first calling TTSBEGIN.&quot;
</code></pre>
<p>To fix the issue, follow these steps.</p>
<ol>
<li>Sign in to the virtual machine (VM) for the Finance and Operations app.</li>
<li>Open Visual Studio as an admin, and open the Application Object Tree (AOT).</li>
<li>Search for <strong>DualWriteProjectConfiguration</strong>.</li>
<li>In the AOT, right-click <strong>DualWriteProjectConfiguration</strong>, and select <strong>Add to new project</strong>. Select <strong>OK</strong> to create the new project that uses default options.</li>
<li>In Solution Explorer, right-click <strong>Project properties</strong>, and set <strong>Synchronize Database on Build</strong> to <strong>True</strong>.</li>
<li>Build the project, and confirm that the build is successful.</li>
<li>On the <strong>Dynamics 365</strong> menu, select <strong>Synchronize database</strong>.</li>
<li>Select <strong>Synchronize</strong> to do a full database synchronization.</li>
<li>After the full database synchronization is successful, rerun the database synchronization step in Microsoft Dynamics Lifecycle Services (LCS) and use the manual upgrade scripts as applicable, so that you can proceed with the update.</li>
</ol>
<h2 id="missing-table-columns-issue-on-maps">Missing table columns issue on maps</h2>
<p><strong>Required role to fix the issue:</strong> System admin</p>
<p>On the <strong>Dual-write</strong> page, you might receive an error message that resembles the following example:</p>
<p><em>Missing source field &lt;field name&gt; in the schema.</em></p>
<p><img src="media/error_missing_field.png" alt="Example of the missing source column error message"></p>
<p>To fix the issue, first follow these steps to make sure that the columns are in the table.</p>
<ol>
<li>Sign in to the VM for the Finance and Operations app.</li>
<li>Go to <strong>Workspaces &gt; Data management</strong>, select the <strong>Framework parameters</strong> tile, and then, on the <strong>Table settings</strong> tab, select <strong>Refresh table list</strong> to refresh the tables.</li>
<li>Go to <strong>Workspaces &gt; Data management</strong>, select the <strong>Data tables</strong> tab, and make sure that the table is listed. If the table isn't listed, sign in to the VM for the Finance and Operations app, and make sure the table is available.</li>
<li>Open the <strong>Table mapping</strong> page from the <strong>Dual-write</strong> page in the Finance and Operations app.</li>
<li>Select <strong>Refresh table list</strong> to automatically fill the columns in the table mappings.</li>
</ol>
<p>If the issue still isn't fixed, follow these steps.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>These steps guide you through the process of deleting a table and then adding it again. To avoid issues, be sure to follow the steps exactly.</p>
</div>
<ol>
<li>In the Finance and Operations app, go to <strong>Workspaces &gt; Data management</strong>, and select the <strong>Data tables</strong> tile.</li>
<li>Find the table that is missing the attribute. Click <strong>Modify target mapping</strong> in the toolbar.</li>
<li>On the <strong>Map staging to target</strong> pane, click <strong>Generate mapping</strong>.</li>
<li>Open the <strong>Table mapping</strong> page from the <strong>Dual-write</strong> page in the Finance and Operations app.</li>
<li>If the attribute is not auto-populated on the map, add it manually by clicking <strong>Add attribute</strong> button and then clicking <strong>Save</strong>.</li>
<li>Select the map and click <strong>Run</strong>.</li>
</ol>
</article>
              </div>
              
<div class="hidden-sm col-md-3" role="complementary">
  <div class="sideaffix">
    <div class="contribution">
      <ul class="nav">
        <li>
          <a href="https://github.com/MicrosoftDocs/Dynamics-365-unified-Operations-public/blob/live/articles/fin-ops-core/dev-itpro/data-entities/dual-write/dual-write-troubleshooting-finops-upgrades.md/#L1" class="contribution-link">Improve this Doc</a>
        </li>
      </ul>
    </div>
    <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
    <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
    </nav>
  </div>
</div>

            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright � 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
