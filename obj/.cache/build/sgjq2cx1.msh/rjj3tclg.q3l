<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Analysen zu Arbeitsbereichen mit Power BI Embedded hinzuf&#252;gen | WIKA Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Analysen zu Arbeitsbereichen mit Power BI Embedded hinzuf&#252;gen | WIKA Documentation ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../../../microsoft-dynamics-crm-365-icon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../commerce/TOC.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="add-analytics-to-workspaces-by-using-power-bi-embedded">Analysen zu Arbeitsbereichen mit Power BI Embedded hinzufügen</h1>

[!include[banner](../includes/banner.md)]
<div class="NOTE">
<h5>Note</h5>
<p>Diese Funktion wird in Finance and Operations (Version 7.2 und höher) unterstützt.</p>
</div>
<h2 id="introduction">Einführung</h2>
<p>Dieses Thema zeigt, wie Sie in die Registerkarte <strong>Analysen</strong> eines Arbeitsbereichs einen Microsoft Power BI-Bericht einbetten. Für das hier gezeigte Beispiel erweitern wir den Arbeitsbereich <strong>Reservierungsverwaltung</strong> in der Anwendung Flottenmanagement, um der Registerkarte <strong>Analysen</strong> einen analytischen Arbeitsbereich hinzuzufügen.</p>
<h2 id="prerequisites">Voraussetzungen</h2>
<ul>
<li>Zugriff auf eine Entwicklerumgebung mit Plattform-Update 8 oder höher.</li>
<li>Einen Analysebericht (PBIX-Datei), der mit Microsoft Power BI Desktop erstellt wurde, und der ein Datenmodell verwendet, das von der Entitätsspeicher-Datenbank gespeist wird.</li>
</ul>
<h2 id="overview">Überblick</h2>
<p>Egal, ob Sie einen vorhandenen Anwendungsarbeitsbereich erweitern oder einen eigenen neuen Arbeitsbereich anlegen, können Sie eingebettete analytische Ansichten nutzen, um informative und interaktive Ansichten Ihrer Geschäftsdaten bereitzustellen. Der Prozess für das Hinzufügen einer Registerkarte mit analytischem Arbeitsbereich umfasst 4 Schritte.</p>
<ol>
<li>Eine .pbix-Datei als Dynamics 365-Ressource hinzufügen.</li>
<li>Eine Registerkarte für einen analytischen Arbeitsbereich definieren.</li>
<li>Die .pbix-Ressource in die Registerkarte mit dem Arbeitsbereich einbetten.</li>
<li>Optional: Erweiterungen hinzufügen, um die Ansicht zu personalisieren.</li>
</ol>
<div class="NOTE">
<h5>Note</h5>
<p>Weitere Informationen zum Erstellen von analytischen Berichten finden Sie unter <a href="https://powerbi.microsoft.com/documentation/powerbi-desktop-getting-started/">Erste Schritte mit Power BI Desktop</a>. Diese Seite enthält wichtige Informationen, die Ihnen helfen, attraktive Lösungen für analytische Berichte zu erstellen.</p>
</div>
<h2 id="add-a-pbix-file-as-a-resource">Eine .pbix-Datei als Ressource hinzufügen</h2>
<p>Bevor Sie anfangen, müssen Sie den Power BI-Bericht erstellen oder erhalten, den Sie in den Arbeitsbereich einbetten wollen. Weitere Informationen zum Erstellen von analytischen Berichten finden Sie unter <a href="https://powerbi.microsoft.com/documentation/powerbi-desktop-getting-started/">Erste Schritte mit Power BI Desktop</a>.</p>
<p>Gehen Sie wie folgt vor, um eine PBIX-Datei als Visual Studio-Projektartefakt hinzuzufügen.</p>
<ol>
<li><p>Erstellen Sie ein neues Projekt im entsprechenden Modell.</p>
</li>
<li><p>Wählen Sie das Projekt im Projektmappen-Explorer aus, klicken Sie mit der rechten Maustaste und wählen Sie dann <strong>Hinzufügen</strong>&gt;<strong>Neues Element</strong>.</p>
</li>
<li><p>Wählen Sie im Dialogfeld <strong>Neues Element hinzufügen</strong> unter <strong>Operations-Artefakte</strong> die Vorlage <strong>Ressource</strong> aus.</p>
</li>
<li><p>Geben Sie einen Namen ein, der für die Referenzierung des Berichts in X++-Metadaten verwendet wird, und klicken Sie dann auf <strong>Hinzufügen</strong>.</p>
<p><img src="media/analytical-workspace-add.png" alt="Dialogfeld Neues Element hinzufügen"></p>
</li>
<li><p>Suchen Sie die .pbix-Datei, die die Definition des analytischen Berichts enthält, und klicken Sie dann auf <strong>Öffnen</strong>.</p>
<p><img src="media/analytical-workspace-select-resource.png" alt="Dialogfeld Auswählen einer Ressourcendatei"></p>
</li>
</ol>
<p>Nachdem Sie die .pbix-Datei als Dynamics 365-Ressource hinzugefügt haben, können Sie die Berichte in Arbeitsbereiche einbetten und unter Verwendung von Menüeinträgen direkte Links hinzufügen.</p>
<h2 id="add-a-tab-control-to-an-application-workspace">Hinzufügen eines Registerkarten-Steuerelements zu einem Anwendungsarbeitsbereich</h2>
<p>In diesem Beispiel erweitern wir den Arbeitsbereich <strong>Reservierungsverwaltung</strong> im Flottenmanagement-Modell, indem wir der Definition des Formulars <strong>FMClerkWorkspace</strong> die Registerkarte <strong>Analysen</strong> hinzufügen.</p>
<p>Die folgende Abbildung zeigt, wie das Formular <strong>FMClerkWorkspace</strong> im Designer in Microsoft Visual Studio aussieht.</p>
<p><img src="media/analytical-workspace-definition-before.png" alt="Formular FMClerkWorkspace vor den Änderungen"></p>
<p>Gehen Sie wie folgt vor, um die Formulardefinition für den Arbeitsbereich <strong>Reservierungsverwaltung</strong> zu erweitern.</p>
<ol>
<li>Öffnen Sie den Formulardesigner, um die Designdefinition zu erweitern.</li>
<li>In dieser Designdefinition wählen Sie das oberste Element aus, <strong>Design | Muster: Arbeitsbereich operational</strong></li>
<li>Klicken Sie mit der rechten Maustaste und wählen Sie dann <strong>Neu</strong>&gt;<strong>Registerkarte</strong>, um das neue Steuerelement <strong>FormTabControl1</strong> hinzuzufügen.</li>
<li>Wählen Sie im Formulardesigner <strong>FormTabControl1</strong>.</li>
<li>Klicken Sie mit der rechten Maustaste und wählen Sie dann <strong>Neue Registerkartenseite</strong>, um eine neue Registerkartenseite hinzuzufügen.</li>
<li>Geben Sie der Registerkarte einen sprechenden Namen, wie beispielsweise <strong>Arbeitsbereich</strong>.</li>
<li>Wählen Sie im Formulardesigner <strong>FormTabControl1</strong>.</li>
<li>Klicken Sie mit der rechten Maustaste und wählen Sie dann <strong>Neue Registerkartenseite</strong>.</li>
<li>Geben Sie der Registerkarte einen sprechenden Namen, wie beispielsweise <strong>Analysen</strong>.</li>
<li>Wählen Sie im Formulardesigner <strong>Analysen (Registerkartenseite)</strong>.</li>
<li>Legen Sie die Eigenschaft <strong>Bildbeschriftung</strong> auf <strong>Analytik</strong> und die Eigenschaft <strong>Automatische Deklaration</strong> auf <strong>Ja</strong> fest.</li>
<li>Klicken Sie mit der rechten Maustaste auf das Steuerelement und wählen Sie dann <strong>Neu</strong>&gt;<strong>Gruppe</strong>, um ein neues Formulargruppensteuerelement hinzuzufügen.</li>
<li>Geben Sie der Formulargruppe einen sprechenden Namen, wie beispielsweise <strong>powerBIReportGroup</strong>.</li>
<li>Wählen Sie im Formulardesigner <strong>PanoramaBody (Registerkarte)</strong> und ziehen Sie das Steuerelement auf die Registerkarte <strong>Arbeitsbereich</strong>.</li>
<li>In dieser Designdefinition wählen Sie das oberste Element aus, <strong>Design | Muster: Arbeitsbereich operational</strong></li>
<li>Klicken Sie mit der rechten Maustaste und wählen Sie dann <strong>Muster entfernen</strong>.</li>
<li>Klicken Sie erneut mit der rechten Maustaste und wählen Sie dann <strong>Muster hinzufügen</strong>&gt;<strong>Arbeitsbereich mit Registerkarten</strong>.</li>
<li>Führen Sie einen Build aus, um Ihre Änderungen zu überprüfen.</li>
</ol>
<p>Die folgende Abbildung zeigt, wie das Design nach Anwendung dieser Änderungen aussieht.</p>
<p><img src="media/analytical-workspace-definition-after.png" alt="FMClerkWorkspace nach den Änderungen"></p>
<p>Nachdem Sie die Steuerelemente für das Formular hinzugefügt haben, die für die Einbettung des Arbeitsbereichberichts verwendet werden, müssen Sie die Größe des übergeordneten Steuerelements definieren, sodass es zum Layout passt. Standardmäßig werden die Seite <strong>Filter</strong> und die Seite <strong>Registerkarte</strong> auf dem Bericht angezeigt. Sie können die Sichtbarkeit dieser Steuerelemente jedoch abhängig vom Zielpublikum des Berichts abändern.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Für eingebettete Arbeitsbereiche empfehlen wir, der Konsistenz halber Erweiterungen zu verwenden, um die Seiten <strong>Filter</strong> und <strong>Registerkarte</strong> auszublenden.</p>
</div>
<p>Damit haben Sie die Aufgabe fertiggestellt, die Definition des Anwendungsformulars zu erweitern. Weitere Informationen zur Verwendung von Erweiterungen für Anpassungen finden Sie in <a href="https://docs.microsoft.com/de-de/dynamics365/supply-chain/fin-ops-core/dev-itpro/extensibility/customization-overlayering-extensions">Anpassen durch Erweiterungen und Überlagerung (This is an external link)</a>.</p>
<h2 id="add-x-business-logic-to-embed-a-viewer-control">Hinzufügen einer X++-Geschäftslogik, um ein Viewer-Steuerelement einzubetten</h2>
<p>Gehen Sie wie folgt vor, um eine Geschäftslogik hinzuzufügen, die das Steuerelement für den Bericht-Viewer initialisiert, das in den Arbeitsbereich <strong>Reservierungsverwaltung</strong> eingebettet ist.</p>
<ol>
<li><p>Öffnen Sie den Formulardesigner <strong>FMClerkWorkspace</strong>, um die Designdefinition zu erweitern.</p>
</li>
<li><p>Drücken Sie F7, um auf den Code hinter der Codedefinition zuzugreifen.</p>
</li>
<li><p>Fügen Sie den folgenden X++-Code hinzu.</p>
<pre><code class="lang-xpp">[Form] 
public class FMClerkWorkspace extends FormRun
{
    private boolean initReportControl = true;
    protected void initAnalyticalReport()
    {
        if (!initReportControl)
        {
            return;
        }
        // Note: secure entry point into the Workspace's Analytics report
        if (Global::hasMenuItemAccess(menuItemDisplayStr(FMClerkWorkspace), MenuItemType::Display))
        {
            // initialize the PBI report control using shared helper
            PBIReportHelper::initializeReportControl('FMPBIWorkspaces', powerBIReportGroup);
        }
        initReportControl = false;
    }
    /// &lt;summary&gt;
    /// Initializes the form.
    /// &lt;/summary&gt;
    public void init()
    {
        super();
        this.initAnalyticalReport();
    }
}
</code></pre>
</li>
<li><p>Führen Sie einen Build aus, um Ihre Änderungen zu überprüfen.</p>
</li>
</ol>
<p>Damit haben Sie die Aufgabe abgeschlossen, die Geschäftslogik hinzuzufügen, mit der das eingebettete Steuerelement für den Bericht-Viewer initialisiert wird. Die folgende Abbildung zeigt, wie der Arbeitsbereich nach Anwendung dieser Änderungen aussieht.</p>
<p><img src="media/analytical-workspace-final.png" alt="In den Arbeitsbereich eingebetteter Bericht"></p>
<div class="NOTE">
<h5>Note</h5>
<p>Über die Registerkarten des Arbeitsbereichs unterhalb der Seitenüberschrift können Sie auf die vorhandene sofort ausgeführte Ansicht zugreifen.</p>
</div>
<h2 id="reference">Referenz</h2>
<h3 id="pbireporthelperinitializereportcontrol-method">Die Methode PBIReportHelper.initializeReportControl</h3>
<p>Dieser Abschnitt enthält Informationen über die Helferklasse, mit der ein Power BI-Bericht (PBIX-Ressource) in ein Formular-Gruppensteuerelement eingebettet wird.</p>
<h4 id="syntax">Syntax</h4>
<pre><code class="lang-xpp">public static void initializeReportControl(
    str                 _resourceName,
    FormGroupControl    _formGroupControl,
    str                 _defaultPageName = '',
    boolean             _showFilterPane = false,
    boolean             _showNavPane = false,
    List                _defaultFilters = new List(Types::Class))
</code></pre>
<h4 id="parameters">Parameter</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td>resourceName</td>
<td>Der Name der .pbix-Ressource.</td>
</tr>
<tr>
<td>formGroupControl</td>
<td>Das Formular-Gruppensteuerelement, auf das das Power BI-Berichtssteuerelement angewendet wird.</td>
</tr>
<tr>
<td>defaultPageName</td>
<td>Der Standardseitenname.</td>
</tr>
<tr>
<td>showFilterPane</td>
<td>Ein boolescher Wert, der angibt, ob der Filterbereich angezeigt (<strong>true</strong>) oder ausgeblendet (<strong>false</strong>) werden soll.</td>
</tr>
<tr>
<td>showNavPane</td>
<td>Ein boolescher Wert, der angibt, ob der Navigationsbereich angezeigt (<strong>true</strong>) oder ausgeblendet (<strong>false</strong>) werden soll.</td>
</tr>
<tr>
<td>defaultFilters</td>
<td>Die Standardfilter für den Power BI-Bericht.</td>
</tr>
</tbody>
</table>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
