<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Add new fields to a business document template in Microsoft Excel | WIKA Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Add new fields to a business document template in Microsoft Excel | WIKA Documentation ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../../../microsoft-dynamics-crm-365-icon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../commerce/TOC.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="add-new-fields-to-a-business-document-template-in-microsoft-excel">Add new fields to a business document template in Microsoft Excel</h1>


<p>You can add new fields to a template that is used to generate business documents in Microsoft Excel format. These fields can be added as placeholders that are used to fill generated documents with required information from the application. For every field that you add, you can also specify a binding to the data sources, to specify what application data will be entered in the field when the template is used to generate business documents.</p>
<p>To learn more about this feature, complete the example in this topic. This example shows how to update a template to fill in the fields in free text invoice forms that are generated.</p>
<h2 id="configure-business-document-management-to-edit-templates">Configure Business document management to edit templates</h2>
<p>Because Business document management (BDM) is built on top of the <a href="general-electronic-reporting.html">Electronic reporting (ER) overview</a> framework, you must configure the required ER and BDM parameters before you can start to work with BDM.</p>
<ol>
<li><p>Sign in to the instance of Microsoft Dynamics 365 Finance as the system administrator.</p>
</li>
<li><p>Complete the following steps of the example in the <a href="er-business-document-management.html">Business document management overview</a> topic:</p>
<ol>
<li>Configure ER parameters.</li>
<li>Turn on BDM.</li>
</ol>
</li>
</ol>
<p>You can now start to use BDM to edit business document templates.</p>
<h2 id="import-er-solutions-that-contain-a-template">Import ER solutions that contain a template</h2>
<p>The example in this procedure uses the officially published ER solution. You must import the ER configurations of this solution into your current instance of Finance.</p>
<p>The <strong>Free text invoice (Excel)</strong> ER format configuration of this solution contains the business document template in Excel format that can be edited by using BDM. Import the latest version of this ER format configuration from Microsoft Dynamics Lifecycle Service (LCS). The corresponding ER data model and ER model mapping configurations will be imported automatically.</p>
<p>For more information about how to import ER configurations, see <a href="general-electronic-reporting-manage-configuration-lifecycle.html">Manage the ER configuration lifecycle</a>.</p>
<p><img src="./media/BDM-AddFldExcel-LCS.png" alt="LCS Shared asset library page"></p>
<h3 id="edit-the-er-solution-template">Edit the ER solution template</h3>
<ol>
<li><p>Sign in as a user who has access to the <strong>Business document management</strong> workspace.</p>
</li>
<li><p>Open the <strong>Business document management</strong> workspace.</p>
<p><img src="./media/BDM-AddFldExcel-Workspace.png" alt="Business document management workspace"></p>
</li>
<li><p>In the grid, select the <strong>Free text invoice (Excel)</strong> template.</p>
</li>
<li><p>In the right pane, select <strong>New template</strong> to create a new template that is based on the selected template.</p>
</li>
<li><p>In the <strong>Title</strong> field, enter <strong>Free text invoice (Excel) Contoso</strong> as the title of the new template.</p>
</li>
<li><p>Select <strong>OK</strong> to confirm the start of the editing process.</p>
</li>
</ol>
<p>The BDM template editor page appears. You can use Microsoft 365 to edit the selected template online in the embedded control.</p>
<p><img src="./media/BDM-AddFldExcel-EditableTemplate.png" alt="BDM template editor page"></p>
<h3 id="add-the-label-for-a-new-field-to-the-template">Add the label for a new field to the template</h3>
<ol>
<li><p>On the BDM template editor page, on the Excel ribbon, on the <strong>View</strong> tab, select the <strong>Headings and Gridlines</strong> check boxes for the editable Excel template.</p>
<p><img src="./media/BDM-AddFldExcel-EditableTemplate2.png" alt="Headings and Gridlines check boxes selected"></p>
</li>
<li><p>Select cells <strong>E8:F8</strong>.</p>
</li>
<li><p>On the Excel ribbon, on the <strong>Home</strong> tab, select <strong>Merge &amp; Center</strong> to merge the selected cells into a new merged <strong>E8:F8</strong> cell.</p>
</li>
<li><p>In the merged cell <strong>E8:F8</strong>, enter <strong>URL</strong>.</p>
</li>
<li><p>Select merged cell <strong>E7:F7</strong>, select <strong>Format painter</strong>, and then select merged cell <strong>E8:F8</strong> to format it in the same way as merged cell <strong>E7:F7</strong>.</p>
<p><img src="./media/BDM-AddFldExcel-EditableTemplate3.png" alt="New field label added to the template"></p>
</li>
</ol>
<h3 id="format-the-template-to-reserve-space-for-a-new-field">Format the template to reserve space for a new field</h3>
<ol>
<li><p>On the BDM template editor page, select merged cell <strong>G8:H8</strong>.</p>
</li>
<li><p>On the Excel ribbon, on the <strong>Home</strong> tab, select <strong>Merge &amp; Center</strong> to merge the selected cells into a new merged <strong>G8:H8</strong> cell.</p>
</li>
<li><p>Select merged cell <strong>G7:H7</strong>, select <strong>Format painter</strong>, and then select merged cell <strong>G8:H8</strong> to format it in the same way as merged cell <strong>G7:H7</strong>.</p>
<p><img src="./media/BDM-AddFldExcel-EditableTemplate4.png" alt="Space reserved for the new field"></p>
</li>
<li><p>In the <strong>Name</strong> box field, select <strong>CompanyInfo</strong>.</p>
<p>The <strong>CompanyInfo</strong> range of the current Excel template holds all the fields that are used to fill the header of a generated report with the details of the current company as a seller party.</p>
<p><img src="./media/BDM-AddFldExcel-SelectCompanyInfoRange.png" alt="CompanyInfo range selected"></p>
</li>
</ol>
<h3 id="add-a-new-field-to-the-template">Add a new field to the template</h3>
<ol>
<li><p>On the <strong>BDM template editor</strong> page, on the Action Pane, select <strong>Show format</strong>.</p>
</li>
<li><p>In the <strong>Template structure</strong> pane, select <strong>Add</strong>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You must adjust the section of the template that you want to use as a new field. You already made this adjustment by formatting merged cell <strong>G8:H8</strong>.</p>
</div>
<p><img src="./media/BDM-AddFldExcel-AddCell.png" alt="Adding a new field to the template"></p>
</li>
<li><p>Select <strong>Excel\Cell</strong> to add a new field as a cell in the template.</p>
<p>You can select <strong>Excel\Range</strong> if you want to add a new range to the template. The range that is entered can contain multiple cells. You can add these cells later.</p>
<p>Notice that the <strong>CompanyInfo</strong> template component, is automatically selected in the <strong>Template structure</strong> pane, because it's the most suitable parent component in the current template structure for the field that you're adding.</p>
</li>
<li><p>In the <strong>Excel range</strong> field, enter <strong>CompanyURL_Value</strong>.</p>
</li>
<li><p>Select <strong>OK</strong>.</p>
<p><img src="./media/BDM-AddFldExcel-EditableTemplate5.png" alt="CompanyURL_Value field added to the template structure"></p>
</li>
<li><p>In the <strong>Template structure</strong> pane, select the ellipsis button (...), and then select <strong>Show bindings</strong>.</p>
<p><img src="./media/BDM-AddFldExcel-ShowBindings.png" alt="Show bindings selected"></p>
<p>The <strong>Template structure</strong> pane now shows the data sources that are available in the underlying ER format.</p>
</li>
<li><p>Select <strong>CompanyInfo_Value</strong> as the field that you plan to bind to a data source of the underlying ER format.</p>
</li>
<li><p>In the <strong>Data sources</strong> section of the <strong>Template structure</strong> pane, expand <strong>Model &gt; InvoiceBase &gt; CompanyInfo</strong>.</p>
</li>
<li><p>Under <strong>CompanyInfo</strong>, select the <strong>WebsiteURI</strong> item.</p>
<p><img src="./media/BDM-AddFldExcel-BindURL.png" alt="WebsiteURI item selected"></p>
</li>
<li><p>Select <strong>Bind</strong>.</p>
</li>
<li><p>In the <strong>Template structure</strong> pane, select <strong>Save</strong>, and then close the BDM template editor page.</p>
</li>
</ol>
<p>In the <strong>Business document management</strong> workspace, the <strong>Template</strong> tab in the right pane shows the updated template. In the grid, notice that the <strong>Status</strong> field for the edited template has been changed to <strong>Draft</strong>, and the <strong>Revision</strong> field is no longer blank. These changes indicate that the process of editing this template has been started.</p>
<p><img src="./media/BDM-AddFldExcel-Workspace2.png" alt="Edited template in the Business document management workspace"></p>
<h2 id="review-company-settings">Review company settings</h2>
<ol>
<li>Go to <strong>Organization administration &gt; Organizations &gt; Legal entities</strong>.</li>
<li>On the <strong>Contact information</strong> FastTab, verify that the company URL is entered.</li>
</ol>
<p><img src="./media/BDM-AddFldExcel-CompanyInfo.png" alt="Company URL entered on the Legal entities page"></p>
<h2 id="generate-business-documents-to-test-the-updated-template">Generate business documents to test the updated template</h2>
<ol>
<li><p>In the application, change the company to <strong>USMF</strong>, and go to <strong>Accounts receivable &gt; Invoices &gt; All free text invoices</strong>.</p>
</li>
<li><p>Select invoice <strong>FTI-00000002</strong>, and then select <strong>Print management</strong>.</p>
</li>
<li><p>In the left pane, expand <strong>Module - accounts receivable &gt; Documents &gt; Free text invoice</strong>.</p>
</li>
<li><p>Under <strong>Free text invoice</strong>, select the <strong>Original document</strong> level to specify the scope of invoices for processing.</p>
</li>
<li><p>In the right pane, in the <strong>Report format</strong> field, select the <strong>Free text invoice (Excel) Contoso</strong> template for the specified document level.</p>
<p><img src="./media/BDM-AddFldExcel-PrintMngtSetting.png" alt="Free text invoice (Excel) Contoso template selected"></p>
</li>
<li><p>Press <strong>Esc</strong> to close the current page.</p>
</li>
<li><p>Select <strong>Print &gt; Selected</strong>.</p>
</li>
<li><p>Download the generated document, and open it in Excel.</p>
<p><img src="./media/BDM-AddFldExcel-PreviewReport.png" alt="Free text invoice in Excel"></p>
</li>
</ol>
<p>The modified template is used to generate the free text invoice report for the selected item. To analyze how this report is affected by changes that you make to the template, run the report in one application session immediately after you change the template in another application session.</p>
<h2 id="related-links">Related links</h2>
<p><a href="general-electronic-reporting.html">Electronic reporting (ER) overview</a></p>
<p><a href="er-business-document-management.html">Business document management overview</a></p>
<p><a href="tasks/er-design-reports-openxml-2016-11.html">Design a configuration for generating reports in OPENXML format</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
