<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Benutzerdefinierte Speicherorte f&#252;r generierte Dokumente angeben | WIKA Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Benutzerdefinierte Speicherorte f&#252;r generierte Dokumente angeben | WIKA Documentation ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../../../microsoft-dynamics-crm-365-icon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../finance/TOC.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="specify-custom-storage-locations-for-generated-documents" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="24">Benutzerdefinierte Speicherorte für generierte Dokumente angeben</h1>

[!include[banner](../includes/banner.md)]
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="28">Mit der Anwendungsprogrammierschnittstelle (API) des Framework der elektronischen Berichterstellung (ER) können Sie die Liste der Speicherorte für Dokumente, die von ER-Formaten generiert werden, erweitern. In diesem Thema wird erläutert, wie Sie einen benutzerdefinierten Speicherort für generierte Dokumente hinzufügen, indem Sie die Aufgabe zum Erstellen von EB-Zielen an das Standardempfängerwerk delegieren und anschließend eine benutzerdefinierte Klasse mit eigener Ziellogik implementieren.</p>
<h2 id="prerequisites" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="30">Voraussetzungen</h2>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="32">Stellen Sie eine Topologie bereit, die einen fortlaufenden Build unterstützt. Weitere Informationen finden Sie unter <a href="https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/perf-test/continuous-build-test-automation" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="32">Bereitstellen von Topologien, die fortlaufenden Build und Testautomatisierung unterstützen</a> Sie unter. Sie müssen für eine der folgenden Rollen Zugriff auf diese Topologie haben:</p>
<ul sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="34">
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="34">Entwickler für elektronische Berichterstellung</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="35">Funktionaler Berater für elektronische Berichterstellung</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="36">Systemadministrator</li>
</ul>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="38">Sie müssen zudem Zugriff auf die Entwicklungsumgebung für diese Topologie haben.</p>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="40">Alle Aufgaben in diesem Thema können im <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="40">USMF</strong>-Unternehmen erledigt werden.</p>
<h2 id="import-the-fixed-asset-roll-forward-er-format" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="42">EB-Format „Rollforward für Anlagen“ importieren</h2>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="44">Um die Dokumente zu generieren, für die Sie einen benutzerdefinierten Speicherort hinzufügen möchten, <a href="er-download-configurations-global-repo.html" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="44">importieren</a> Sie das EB-Format <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="44">Rollforward für Anlagen</strong> in die aktuelle Topologie.</p>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="46"><img src="media/er-custom-storage-generated-files-import-format.png" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="46" alt="Konfigurationsrepository-Seite"></p>
<h2 id="run-the-fixed-asset-roll-forward-report" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="48">Bericht „Rollforward für Anlagen“ ausführen</h2>
<ol sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="50">
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="50">Wechseln Sie zu <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="50">Anlage</strong> &gt; <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="50">Anfragen und Berichte</strong> &gt; <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="50">Transaktionsberichte</strong> &gt; <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="50">Rollforward für Anlagen</strong>.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="51">Geben Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="51">Von Datum</strong> das Datum <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="51">1/1/2017</strong> (1. Januar 2017) ein.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="52">Geben Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="52">Bis Datum</strong> das Datum <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="52">1/31/2017</strong> (31. Januar 2017) ein.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="53">Wählen Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="53">Währung</strong> die Option <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="53">Buchhaltungswährung</strong> aus.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="54">Wählen Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="54">Formatzuordnung</strong> die Option <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="54">Rollforward für Anlagen</strong> aus.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="55">Wählen Sie <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="55">OK</strong>.</li>
</ol>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="57"><img src="media/er-custom-storage-generated-files-runtime-dialog.png" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="57" alt="Dialogfeld „Laufzeit“ für den Bericht „Rollforward für Anlagen“"></p>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="59">Überprüfen Sie in Microsoft Excel das ausgehende Dokument, das generiert wurde und zum Download zur Verfügung steht. Dieses Verhalten ist das <a href="electronic-reporting-destinations.html#default-behavior" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="59">Standardverhalten</a> für ein EB-Format, für das keine <a href="electronic-reporting-destinations.html" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="59">Ziele</a> konfiguriert sind und das im interaktiven Modus ausgeführt wird.</p>
<h2 id="review-the-source-code" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="61">Quellcode überprüfen</h2>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="63">Überprüfen Sie den Code der <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="63">generateReportByGER()</code>-Methode der Klasse <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="63">AssetRollForwardService</code>. Beachten Sie, dass die <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="63">Run()</code>-Methode verwendet wird, um das EB-Framework aufzurufen und den Bericht <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="63">Rollforward für Anlagen</strong> zu generieren.</p>
<pre><code class="lang-xpp" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="65">class AssetRollForwardService extends SysOperationServiceBase
{
    public const str ERFormatModelName = 'Fixed assets';
    public const str ERModelDataSourceName = 'model';
    public const str DefaultExportedFileName = 'AssetRollForward';

    /// &lt;summary&gt;
    /// Generates report by general electronic reporting
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_contract&quot;&gt;The Asset Period Statement contract&lt;/param&gt;
    public void generateReportByGER(AssetRollForwardContract _contract)
    {
        ERFormatMappingId   formatMappingId;
        AssetRollForwardDP  dataProvider;
        AssetRollForwardTmp assetRollForwardTmp;
        Query               query;

        query = new Query(SysOperationHelper::base64Decode(_contract.parmQuery()));
        dataProvider = AssetRollForwardDP::construct();
        formatMappingId = _contract.parmFormatMapping();
        assetRollForwardTmp = dataProvider.getAssetRollForwardTmp(_contract, query);

        if (assetRollForwardTmp)
        {
            try
            {
                ERIModelDefinitionParamsAction parameters = new ERModelDefinitionParamsUIActionComposite()
                    .add(new ERModelDefinitionDatabaseContext().addTemporaryTable(assetRollForwardTmp))
                    .add(new ERModelDefinitionObjectParameterAction(ERModelDataSourceName, 'MyParameters', _contract, true));

                // Call ER to generate the report.
                ERObjectsFactory::createFormatMappingRunByFormatMappingId(formatMappingId, DefaultExportedFileName)
                    .withParameter(parameters)
                    .withFileDestination(_contract.getFileDestination())
                    .run();
            }
            catch
            {
                // An error occurred while exporting data.
                error(&quot;@SYP4861341&quot;);
            }
        }
        else
        {
            // There is no data available.
            info(&quot;@SYS300117&quot;);
        }
    }
}
</code></pre>
<h2 id="modify-the-source-code" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="117">Quellcode ändern</h2>
<ol sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="119">
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="119"><p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="119">Fügen Sie in Ihrem Visual Studio-Projekt eine neue Klasse hinzu (in diesem Beispiel <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="119">AssetRollForwardDestination</code>) und schreiben Sie Code, um Ihr benutzerdefiniertes Ziel für die Berichte <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="119">Rollforward für Anlagen</strong> zu implementieren, die generiert werden.</p>
<ul sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="121">
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="121">Die <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="121">new()</code>-Methode dient zum Abrufen des ursprünglichen EB-Zielobjekts und des von der Anwendungslogik gesteuerten Parameters, der den benutzerdefinierten Speicherort angibt, an dem generierte Berichte gespeichert werden sollen. In diesem Beispiel ist der benutzerdefinierte Speicherort der Name eines Ordners des lokalen Dateisystems auf dem Server, auf dem der AOS-Dienst (Application Object Server) ausgeführt wird.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="122">Die <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="122">saveFile()</code>-Methode dient zum Speichern eines generierten Dokuments in einem Ordner des lokalen Dateisystems auf dem Server, auf dem der AOS-Dienst ausgeführt wird.</li>
</ul>
<pre><code class="lang-xpp" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="124">using Microsoft.Dynamics365.LocalizationFramework;

/// &lt;summary&gt;
/// Destination class for &lt;c&gt;AssetRollForwardDestinationFactory&lt;/c&gt; that stores a generated report.
/// &lt;/summary&gt;
public class AssetRollForwardDestination implements ERIFileDestination
{
    private ERIFileDestination originDestination;
    private str TargetFolder;

    /// &lt;summary&gt;
    /// Creates a stream for new file.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_fileName&quot;&gt;Name of a new file.&lt;/param&gt;
    /// &lt;returns&gt;Stream for new file.&lt;/returns&gt;
    public System.IO.Stream newFileStream(System.String _fileName)
    {
        return originDestination.newFileStream(_fileName);
    }

    /// &lt;summary&gt;
    /// Saves file in destination.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_stream&quot;&gt;A stream to save.&lt;/param&gt;
    /// &lt;param name = &quot;_fileName&quot;&gt;A file name.&lt;/param&gt;
    /// &lt;returns&gt;Saved stream.&lt;/returns&gt;
    public System.IO.Stream saveFile(System.IO.Stream _stream, System.String _fileName)
    {
        _stream.Seek(0, System.IO.SeekOrigin::Begin);
        using (var localStream = System.IO.File::OpenWrite(TargetFolder + _fileName))
        {
            _stream.CopyTo(localStream);
        }
        return _stream;
    }

    /// &lt;summary&gt;
    /// Constructs destination for fixed asset roll forward report.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_originDestination&quot;&gt;The original destination.&lt;/param&gt;
    /// &lt;param name = &quot;_TargetFoder&quot;&gt;The folder to store a report that's being created.&lt;/param&gt;
    /// &lt;returns&gt;The fixed asset roll forward destination.&lt;/returns&gt;
    public static AssetRollForwardDestination construct(ERIFileDestination _originDestination, str _TargetFoder)
    {
        return new AssetRollForwardDestination(_originDestination, _TargetFoder);
    }

    protected void new(ERIFileDestination _originDestination, str _TargetFoder)
    {
        originDestination = _originDestination;
        TargetFolder = _TargetFoder;
    }
}
</code></pre>
</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="180"><p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="180">Fügen Sie in Ihrem Visual Studio-Projekt eine neue Klasse hinzu (in diesem Beispiel <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="180">AssetRollForwardDestinationFactory</code>) und schreiben Sie Code, um ein benutzerdefiniertes Empfängerwerk einzurichten, das die Erstellung eines Ziels an das Standardempfängerwerk delegiert, und um ein Dateiziel mit Ihrem eigenen Ziel zu versehen.</p>
<pre><code class="lang-xpp" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="182">using Microsoft.Dynamics365.LocalizationFramework;
using Microsoft.Dynamics365.LocalizationFramework.Format.FileGeneration;

/// &lt;summary&gt;
/// Destination factory for using &lt;c&gt;AssetRollForwardDestinationFactory&lt;/c&gt;.
/// &lt;/summary&gt;
public class AssetRollForwardDestinationFactory implements ERIFileDestinationFactory, ERIFileDestinationFactoryPostProcessor
{
    private ERIFileDestinationFactory originDestinationFactory;
    private str TargetFolder;

    /// &lt;summary&gt;
    /// Creates file destination for print management.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_fileDestination&quot;&gt;A default file destination.&lt;/param&gt;
    /// &lt;param name = &quot;_identification&quot;&gt;An identification strategy.&lt;/param&gt;
    /// &lt;param name = &quot;_rootContext&quot;&gt;A root context.&lt;/param&gt;
    /// &lt;param name = &quot;_root&quot;&gt;A root element.&lt;/param&gt;
    /// &lt;returns&gt;A file destination.&lt;/returns&gt;
    public ERIDataDrivenFileDestination createPrintMgmtDestination(
        ERIFileDestination _fileDestination,
        ERIObjectIdentificationStrategy _identification,
        ERTextFormatDataContext _rootContext,
        ERTextFormatIFileComponent _root)
    {
        ERIDataDrivenFileDestination dataDrivenDestination = originDestinationFactory.createPrintMgmtDestination(
            _fileDestination,
            _identification,
            _rootContext,
            _root);

        IFileDestinationHost fileDestinationHost = dataDrivenDestination as IFileDestinationHost;
        if (fileDestinationHost)
        {
            fileDestinationHost.FileDestination = AssetRollForwardDestination::construct(
                fileDestinationHost.get_FileDestination(),
                TargetFolder);
        }

        return dataDrivenDestination;
    }

    /// &lt;summary&gt;
    /// Constructs the fixed asset roll forward destination factory.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_originDestinationFactory&quot;&gt;The original destination.&lt;/param&gt;
    /// &lt;param name = &quot;_TargetFolder&quot;&gt;The string containing a folder name that corresponds to the report, that's being created.&lt;/param&gt;
    /// &lt;returns&gt;The destination factory for the fixed asset roll forward report.&lt;/returns&gt;
    public static AssetRollForwardDestinationFactory construct(ERIFileDestinationFactory _originDestinationFactory, str _TargetFolder)
    {
        AssetRollForwardDestinationFactory destinationFactory = new AssetRollForwardDestinationFactory(_originDestinationFactory, _TargetFolder);

        ERIFileDestinationFactoryPostProcessorsHost factoryPostProcessing = ERCast::asObject(destinationFactory.originDestinationFactory) as ERIFileDestinationFactoryPostProcessorsHost;

        if (factoryPostProcessing)
        {
            factoryPostProcessing.addDestinationPostProcessor(destinationFactory);
        }
        return destinationFactory;
    }

    public ERIFileDestination processDestinationAfterCreation(ERIFileDestination _sourceDestination)
    {
        return AssetRollForwardDestination::construct(_sourceDestination, TargetFolder);
    }

    protected void new(ERIFileDestinationFactory _originDestinationFactory, str _TargetFolder)
    {
        originDestinationFactory = _originDestinationFactory;
        TargetFolder = _TargetFolder;
    }
}
</code></pre>
</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="257"><p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="257">Ändern Sie die vorhandene Klasse <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="257">AssetRollForwardService</code> und schreiben Sie Code, um ein benutzerdefiniertes Empfängerwerk für die Berichtsausführung einzurichten. Beachten Sie, dass beim Erstellen eines benutzerdefinierten Empfängerwerks der anwendungsgesteuerte Parameter, der einen Zielordner angibt, übergeben wird. Auf diese Weise wird dieser Zielordner zum Speichern generierter Dateien verwendet.</p>
<div class="NOTE" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="259">
<h5>Note</h5>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="260">Stellen Sie sicher, dass der angegebene Ordner (in diesem Beispiel <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="260">c:\0</strong>) im lokalen Dateisystem des Servers vorhanden ist, auf dem der AOS-Dienst ausgeführt wird. Ansonsten wird zur Laufzeit eine <a href="https://docs.microsoft.com/dotnet/api/system.io.directorynotfoundexception?view=netcore-3.1" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="260">DirectoryNotFoundException</a>-Ausnahme ausgelöst.</p>
</div>
<pre><code class="lang-xpp" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="262">using Microsoft.Dynamics365.LocalizationFramework;
/// &lt;summary&gt;
/// The electronic reporting service class for fixed asset roll forward report
/// &lt;/summary&gt;
class AssetRollForwardService extends SysOperationServiceBase
{
    public const str ERFormatModelName = 'Fixed assets';
    public const str ERModelDataSourceName = 'model';
    public const str DefaultExportedFileName = 'AssetRollForward';

    /// &lt;summary&gt;
    /// Generates report by general electronic reporting
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_contract&quot;&gt;The Asset Period Statement contract&lt;/param&gt;
    public void generateReportByGER(AssetRollForwardContract _contract)
    {
        ERFormatMappingId   formatMappingId;
        AssetRollForwardDP  dataProvider;
        AssetRollForwardTmp assetRollForwardTmp;
        Query               query;

        query = new Query(SysOperationHelper::base64Decode(_contract.parmQuery()));
        dataProvider = AssetRollForwardDP::construct();
        formatMappingId = _contract.parmFormatMapping();
        assetRollForwardTmp = dataProvider.getAssetRollForwardTmp(_contract, query);

        if (assetRollForwardTmp)
        {
            try
            {
                ERIModelDefinitionParamsAction parameters = new ERModelDefinitionParamsUIActionComposite()
                    .add(new ERModelDefinitionDatabaseContext().addTemporaryTable(assetRollForwardTmp))
                    .add(new ERModelDefinitionObjectParameterAction(ERModelDataSourceName, 'MyParameters', _contract, true));

                // Call ER to generate the report.
                ERIFormatMappingRun formatMappingRun = ERObjectsFactory::createFormatMappingRunByFormatMappingId(formatMappingId, DefaultExportedFileName);
                formatMappingRun.withParameter(parameters);
                formatMappingRun.withFileDestination(_contract.getFileDestination());

                ERIFileDestinationFactoryHost factoryHost = ERCast::asObject(formatMappingRun) as ERIFileDestinationFactoryHost;
                if (factoryHost)
                {
                    ERIFileDestinationFactory fileDestinationFactory = factoryHost.getFileDestinationFactory();
                    factoryHost.setFileDestinationFactory(AssetRollForwardDestinationFactory::construct(fileDestinationFactory, @'c:\0\'));
                    formatMappingRun.run();
                }
            }
            catch
            {
                // An error occurred while exporting data.
                error(&quot;@SYP4861341&quot;);
            }
        }
        else
        {
            // There is no data available.
            info(&quot;@SYS300117&quot;);
        }
    }
}
</code></pre>
</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="325"><p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="325">Ihr Projekt neu erstellen</p>
</li>
</ol>
<h2 id="re-run-the-fixed-asset-roll-forward-report" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="327">Bericht „Rollforward für Anlagen“ erneut ausführen</h2>
<ol sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="329">
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="329">Wechseln Sie zu <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="329">Anlage</strong> &gt; <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="329">Anfragen und Berichte</strong> &gt; <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="329">Transaktionsberichte</strong> &gt; <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="329">Rollforward für Anlagen</strong>.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="330">Geben Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="330">Von Datum</strong> den Wert <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="330">1/1/2017</strong> ein.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="331">Geben Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="331">An Datum</strong> den Wert <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="331">1/31/2017</strong> ein.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="332">Wählen Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="332">Währung</strong> die Option <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="332">Buchhaltungswährung</strong> aus.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="333">Wählen Sie im Feld <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="333">Formatzuordnung</strong> die Option <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="333">Rollforward für Anlagen</strong> aus.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="334">Wählen Sie <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="334">OK</strong>.</li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="335">Suchen Sie im lokalen Ordner <strong sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="335">C:\0</strong> dies generierte Datei.</li>
</ol>
<div class="NOTE" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="337">
<h5>Note</h5>
<p sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="338">Weil das <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="338">originDestination</code>-Objekt im <code sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="338">AssetRollForwardDestination</code>-Objekt in diesem Beispiel nicht verwendet wird, werden die Konfigurationen für die <a href="electronic-reporting-destinations.html" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="338">Ziele</a> des EB-Formats zur Laufzeit ignoriert.</p>
</div>
<h2 id="additional-resources" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="340">Zusätzliche Ressourcen</h2>
<ul sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="342">
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="342"><a href="electronic-reporting-destinations.html" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="342">Zielorte für elektronische Berichterstellung (ER)</a></li>
<li sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="343"><a href="https://docs.microsoft.com/de-de/dynamics365/supply-chain/fin-ops-core/dev-itpro/extensibility/extensibility-home-page" sourcefile="articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md" sourcestartlinenumber="343">Startseite für Erweiterbarkeit (This is an external link)</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/togoAIO/d365Doku/blob/main/articles_de/fin-ops-core/dev-itpro/analytics/er-custom-storage-generated-files.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
